# Tier 4: Polymorphic/Union type tests
# Testing: discriminated unions, variant selection, complex filter types

# =============================================================================
# EXECUTE ACTION (Create/Update/Delete variants)
# =============================================================================

- id: t4_action_create_simple
  tier: 4
  prompt: |
    Create a new user named "Alice Johnson"
  expected_tool: execute_action
  expected_args:
    action:
      action_type: "create"
      resource_type: "user"
      name: "Alice Johnson"
      metadata: null
  tags: [polymorphic, action, create]

- id: t4_action_create_with_metadata
  tier: 4
  prompt: |
    Create a new blog post called "Getting Started with Python" with metadata tags: python, tutorial, beginner
  expected_tool: execute_action
  expected_args:
    action:
      action_type: "create"
      resource_type: "post"
      name: "Getting Started with Python"
      metadata:
        tags: ["python", "tutorial", "beginner"]
  tags: [polymorphic, action, create, metadata]

- id: t4_action_update
  tier: 4
  prompt: |
    Update resource ID "usr_12345" and set the email to "newemail@example.com" and status to "active"
  expected_tool: execute_action
  expected_args:
    action:
      action_type: "update"
      resource_id: "usr_12345"
      updates:
        email: "newemail@example.com"
        status: "active"
  tags: [polymorphic, action, update]

- id: t4_action_delete_hard
  tier: 4
  prompt: |
    Permanently delete resource post_98765
  expected_tool: execute_action
  expected_args:
    action:
      action_type: "delete"
      resource_id: "post_98765"
      soft_delete: false
  tags: [polymorphic, action, delete]

- id: t4_action_delete_soft
  tier: 4
  prompt: |
    Soft delete the comment with ID cmt_55555 - we might need to restore it later
  expected_tool: execute_action
  expected_args:
    action:
      action_type: "delete"
      resource_id: "cmt_55555"
      soft_delete: true
  tags: [polymorphic, action, delete, soft]

- id: t4_action_contextual
  tier: 4
  prompt: |
    We need to remove that spam account. The ID is usr_spam_001. Just archive it, don't permanently remove it.
  expected_tool: execute_action
  expected_args:
    action:
      action_type: "delete"
      resource_id: "usr_spam_001"
      soft_delete: true
  tags: [polymorphic, action, contextual]

# =============================================================================
# BUILD QUERY (Mixed filter types)
# =============================================================================

- id: t4_query_text_filter
  tier: 4
  prompt: |
    Find all products where the name contains "wireless"
  expected_tool: build_query
  expected_args:
    filters:
      - filter_type: "text"
        field: "name"
        operator: "contains"
        value: "wireless"
    sort: null
    pagination:
      page: 1
      page_size: 20
  tags: [polymorphic, query, text]

- id: t4_query_numeric_filter
  tier: 4
  prompt: |
    Search for items priced between $50 and $100
  expected_tool: build_query
  expected_args:
    filters:
      - filter_type: "numeric"
        field: "price"
        operator: "between"
        value: 50
        value2: 100
    sort: null
    pagination:
      page: 1
      page_size: 20
  tags: [polymorphic, query, numeric, between]

- id: t4_query_date_filter
  tier: 4
  prompt: |
    Get all orders placed after 2025-01-01
  expected_tool: build_query
  expected_args:
    filters:
      - filter_type: "date"
        field: "created_at"
        operator: "after"
        value: "2025-01-01"
        value2: null
    sort: null
    pagination:
      page: 1
      page_size: 20
  tags: [polymorphic, query, date]

- id: t4_query_mixed_filters
  tier: 4
  prompt: |
    Find products where category equals "electronics" and price is less than 500,
    sorted by price descending, page 2 with 10 items per page.
  expected_tool: build_query
  expected_args:
    filters:
      - filter_type: "text"
        field: "category"
        operator: "equals"
        value: "electronics"
      - filter_type: "numeric"
        field: "price"
        operator: "lt"
        value: 500
        value2: null
    sort:
      field: "price"
      direction: "desc"
    pagination:
      page: 2
      page_size: 10
  tags: [polymorphic, query, mixed, complex]

- id: t4_query_complex
  tier: 4
  prompt: |
    Search for active users whose email starts with "admin" and who signed up
    between 2024-06-01 and 2024-12-31. Sort by signup date ascending, show 50 per page.
  expected_tool: build_query
  expected_args:
    filters:
      - filter_type: "text"
        field: "status"
        operator: "equals"
        value: "active"
      - filter_type: "text"
        field: "email"
        operator: "starts_with"
        value: "admin"
      - filter_type: "date"
        field: "signup_date"
        operator: "between"
        value: "2024-06-01"
        value2: "2024-12-31"
    sort:
      field: "signup_date"
      direction: "asc"
    pagination:
      page: 1
      page_size: 50
  tags: [polymorphic, query, complex, multi-filter]

# =============================================================================
# SEND NOTIFICATION (Email/SMS/Push variants)
# =============================================================================

- id: t4_notify_email
  tier: 4
  prompt: |
    Send an email to support@company.com with subject "Bug Report" and body "Found a critical issue in the checkout flow"
  expected_tool: send_notification
  expected_args:
    notification:
      channel: "email"
      to: "support@company.com"
      subject: "Bug Report"
      body: "Found a critical issue in the checkout flow"
    priority: "normal"
  tags: [polymorphic, notification, email]

- id: t4_notify_email_urgent
  tier: 4
  prompt: |
    URGENT: Email the CEO (ceo@corp.com) about the security incident. Subject: "Security Alert - Immediate Action Required". Body: "Potential breach detected in production systems."
  expected_tool: send_notification
  expected_args:
    notification:
      channel: "email"
      to: "ceo@corp.com"
      subject: "Security Alert - Immediate Action Required"
      body: "Potential breach detected in production systems."
    priority: "high"
  tags: [polymorphic, notification, email, urgent]

- id: t4_notify_sms
  tier: 4
  prompt: |
    Text +1-555-123-4567: "Your order has shipped! Track at: ship.co/ABC123"
  expected_tool: send_notification
  expected_args:
    notification:
      channel: "sms"
      phone_number: "+1-555-123-4567"
      message: "Your order has shipped! Track at: ship.co/ABC123"
    priority: "normal"
  tags: [polymorphic, notification, sms]

- id: t4_notify_push
  tier: 4
  prompt: |
    Send a push notification to device dev_iphone_001 with title "New Message" and body "You have 3 unread messages"
  expected_tool: send_notification
  expected_args:
    notification:
      channel: "push"
      device_id: "dev_iphone_001"
      title: "New Message"
      body: "You have 3 unread messages"
      data: null
    priority: "normal"
  tags: [polymorphic, notification, push]

- id: t4_notify_push_with_data
  tier: 4
  prompt: |
    High priority push to device mobile_android_xyz. Title: "Payment Received".
    Body: "Your payment of $150 was processed". Include data payload with amount=150 and transaction_id="txn_99887766".
  expected_tool: send_notification
  expected_args:
    notification:
      channel: "push"
      device_id: "mobile_android_xyz"
      title: "Payment Received"
      body: "Your payment of $150 was processed"
      data:
        amount: 150
        transaction_id: "txn_99887766"
    priority: "high"
  tags: [polymorphic, notification, push, data]

# =============================================================================
# AMBIGUOUS / CONTEXTUAL (harder variant selection)
# =============================================================================

- id: t4_action_ambiguous_remove
  tier: 4
  prompt: |
    Remove the test account test_user_123 from the system
  expected_tool: execute_action
  expected_args:
    action:
      action_type: "delete"
      resource_id: "test_user_123"
      soft_delete: false
  tags: [polymorphic, action, ambiguous]

- id: t4_notify_contextual
  tier: 4
  prompt: |
    Let the customer know their delivery is on the way. Their phone is +44-7700-900123.
    Keep it short - just say "Your package is out for delivery!"
  expected_tool: send_notification
  expected_args:
    notification:
      channel: "sms"
      phone_number: "+44-7700-900123"
      message: "Your package is out for delivery!"
    priority: "normal"
  tags: [polymorphic, notification, contextual]
